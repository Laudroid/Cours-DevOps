Voici la présentation de 6 slides sur les outils de logging :

---

## Outils de Logging : ELK Stack et Grafana Loki

Le logging est central pour l'observabilité. Il permet la collecte, la recherche et l'analyse des événements produits par les applications et infrastructures.

Nous explorerons deux outils majeurs :
1.  **ELK Stack** (Elasticsearch, Logstash, Kibana)
2.  **Grafana Loki**

---

## ELK Stack : La Solution Robuste pour la Gestion des Logs

**1. Composition :**
*   **Elasticsearch** : Moteur de recherche et base de données distribuée pour l'indexation.
*   **Logstash** : Pipeline de collecte, transformation et enrichissement des logs.
*   **Kibana** : Interface graphique pour visualiser et analyser les journaux.

**2. Fonctionnement :**
Les logs sont collectés par Logstash, transformés, puis envoyés à Elasticsearch pour stockage. Kibana crée des dashboards et requêtes analytiques en temps réel.

**3. Atouts et Limites :**

| Points forts                         | Limites                             |
|------------------------------------|-----------------------------------|
| Très robuste et évolutif            | Consommation mémoire et CPU élevée|
| Recherche full-text puissante       | Complexité du déploiement          |
| Écosystème riche de plugins         | Indexation parfois coûteuse en stockage |

---

## Grafana Loki : Le "Prometheus des Logs"

**1. Concept :**
Loki est un système de collecte et stockage de logs **étiquetés (label-based)**, conçu pour être léger. Il n'indexe pas le contenu complet des logs mais seulement leurs labels, ce qui réduit les coûts et accélère les ingestions.

**2. Architecture :**
*   **Promtail** : Agent léger qui collecte et étiquette les logs.
*   **Loki** : Serveur qui stocke et propose une recherche basée sur labels.
*   **Grafana** : Visualisation et corrélation native avec métriques et traces.

**3. Cas d’usage :**
Particulièrement adapté aux environnements cloud natifs, microservices et Kubernetes où les logs sont volumineux et nécessitent une corrélation rapide avec les métriques.

---

## Exemples d'Usage et d'Intégration

**1. Exemple ELK Stack :**
*   Collecte de logs applicatifs JSON.
*   Parsing de champs spécifiques (timestamp, niveau, message).
*   Alertes basées sur requêtes Kibana (ex : détection d’erreurs répétées).

**2. Exemple d’intégration Loki avec Promtail :**
```yaml
scrape_configs:
  - job_name: system
    static_configs:
      - targets:
          - localhost
        labels:
          job: varlogs
          __path__: /var/log/*.log
```
**3. Requête Loki dans Grafana :**
```logql
{job="varlogs"} |= "error"
```
Recherche les lignes contenant "error" pour les logs du job "varlogs".

---

## ELK vs Loki : Choisir la Bonne Solution

| Critères             | ELK Stack                         | Grafana Loki                      |
|----------------------|----------------------------------|----------------------------------|
| Indexation           | Texte intégral (complet)          | Par labels uniquement            |
| Complexité déploiement | Assez élevé                     | Plus simple                      |
| Coût en ressources    | Important                        | Optimisé                        |
| Corrélation métriques | Nécessite intégration externe   | Native avec Grafana              |
| Cas d’usage           | Analyse log exhaustive, historique | Logs conteneurisés en production |

---

## Synthèse et Ressources Clés

**Ce qu'il faut retenir :**
*   **ELK Stack** : Solution complète et performante pour une analyse exhaustive des logs avec recherche full-text.
*   **Grafana Loki** : Alternative légère et optimisée pour les environnements modernes, offrant une corrélation native avec métriques et traces.
*   Le choix dépend du contexte, de la volumétrie des logs, des besoins d'analyse et des ressources disponibles.

**Sources et documentation :**
*   Elastic.co, *ELK Stack Overview* : https://www.elastic.co/elk-stack
*   Grafana Labs, *Introducing Loki* : https://grafana.com/docs/loki/latest/
*   Promtail documentation : https://grafana.com/docs/loki/latest/clients/promtail/
*   CNCF Observability Landscape : https://landscape.cncf.io/category=logging