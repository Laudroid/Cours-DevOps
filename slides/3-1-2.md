## Les concepts clés de Docker : Image, Conteneur, Dockerfile et Docker Compose

Docker est devenu un standard de la conteneurisation grâce à des concepts simples mais puissants. Pour le maîtriser, il est essentiel de comprendre quatre notions fondamentales : les images, les conteneurs, les Dockerfiles et Docker Compose.

---

## 1. Docker Image : Le Modèle Immuable

Une **image Docker** est un template en lecture seule qui contient tout le nécessaire pour exécuter une application : code, bibliothèques, dépendances et configuration système.

*   **Immuable et versionnée** : Construite en couches, optimise le stockage et les transferts.
*   **Stockage** : Registres dédiés (Docker Hub, GitLab Container Registry...).
*   **Rôle** : Sert de base pour créer des conteneurs.

### Exemple : Récupérer une image Node.js 16
```bash
docker pull node:16
```
*(L'image `node:16` contient Node.js 16 préinstallé sur un système Linux léger.)*

---

## 2. Conteneur : L'Instance Exécutable Isolée

Un **conteneur** est une instance active et isolée d'une image, dans laquelle tourne un processus.

*   **Léger et rapide** : Utilise les ressources du noyau de l'hôte.
*   **Volatile** : Conserve l'état seulement si des volumes sont montés.
*   **Scalable** : Plusieurs conteneurs peuvent être lancés simultanément depuis une même image.

### Exemple : Lancer un conteneur Node.js interactif
```bash
docker run -it node:16 bash
```
*(Ceci démarre un shell dans un conteneur basé sur l'image `node:16`.)*

---

## 3. Dockerfile : Le Script de Construction d'Image

Un **Dockerfile** est un fichier texte décrivant les étapes pour construire une image Docker : installation de paquets, copie de fichiers, exposition de ports, etc.

### Structure simple d'un Dockerfile
```dockerfile
FROM node:16          # Point de départ : image Node.js 16
WORKDIR /app          # Définit le répertoire de travail dans le conteneur
COPY package*.json ./ # Copie les fichiers de dépendances
RUN npm install       # Installe les dépendances
COPY . .              # Copie le reste du code de l'application
CMD ["node", "index.js"] # Commande lancée au démarrage du conteneur
```

### Pour construire l'image
```bash
docker build -t mon-app-node .
```

---

## 4. Docker Compose : Orchestration Multi-Conteneurs

**Docker Compose** permet de définir et gérer plusieurs conteneurs (services) d'une application dans un fichier YAML. Il simplifie le déploiement d'applications multi-conteneurs (ex: application web + base de données).

### Exemple de `docker-compose.yml`
```yaml
version: "3"
services:
  app:
    build: .             # Construit l'image depuis le Dockerfile local
    ports:
      - "3000:3000"      # Mappe le port 3000 de l'hôte au port 3000 du conteneur
    volumes:
      - .:/app           # Monte le répertoire courant dans /app du conteneur
    depends_on:
      - db               # Démarre 'db' avant 'app'

  db:
    image: postgres:14   # Utilise l'image PostgreSQL 14
    environment:         # Variables d'environnement pour la BDD
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: appdb
    volumes:
      - pgdata:/var/lib/postgresql/data # Volume persistant pour les données de la BDD

volumes:
  pgdata: # Déclaration du volume
```

### Démarrage des services
```bash
docker-compose up -d
```

---

## Ce qu'il faut retenir & Sources

### Essentiel à la Maîtrise de Docker
Docker se distingue par son écosystème structuré autour de :
*   **Images immuables** : Modèles fiables et réutilisables.
*   **Conteneurs légers** : Environnements isolés et rapidement exécutables.
*   **Dockerfiles modulaires** : Scripts clairs pour construire vos images.
*   **Docker Compose simplifié** : Gestion aisée des applications multi-conteneurs.

Maîtriser ces concepts est indispensable pour construire, déployer et scaler des applications conteneurisées efficacement.

### Sources utilisées
*   Docker Docs - Concepts clés : https://docs.docker.com/get-started/overview/
*   Docker Docs - Dockerfile reference : https://docs.docker.com/engine/reference/builder/
*   Docker Docs - Docker Compose : https://docs.docker.com/compose/
*   DigitalOcean, *Docker for Beginners* : https://www.digitalocean.com/community/tutorial_series/docker-for-beginners